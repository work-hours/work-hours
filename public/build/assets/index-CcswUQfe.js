import{r as m,c as se,j as e,H as oe,L as R}from"./app-CE94QcfB.js";import{E as ie}from"./action-buttons-DllMgloq.js";import{J as G}from"./jira-icon-pYe84P2s.js";import{B as f}from"./button-CSc-Cw7e.js";import{C as ce,a as ne,b as me,c as q,d as de}from"./card-BF0DTRGt.js";import{a as le,b as xe,c as he,D as y}from"./dropdown-menu-Dy5Hq4rj.js";import{T as pe,a as ge,b as ue,c as g,d as fe,e as ye,f as u}from"./table-C7t7xskR.js";import{M as je}from"./master-layout-tsVhh441.js";import{q as be}from"./utils-DKW5XViW.js";import Ne from"./ProjectFiltersOffCanvas-ELHw1g9d.js";import ke from"./ProjectOffCanvas-B7bbjuV4.js";import{r as l,b as k,m as w,v as z,l as K,t as v}from"./TaskController-DRILXs0Z.js";import{t as D}from"./index-C5Svuudg.js";import we from"./ProjectDeleteAction-CvIFQqqk.js";import{S as ve,P as Se}from"./ProjectNotesSheet-COGh0dnB.js";import{F as Pe}from"./filter-BedxScMf.js";import{F as B}from"./folder-plus-Uh_yi0v0.js";import{L as U}from"./loader-circle-D1ym3s0F.js";import{c as Ce}from"./createLucideIcon-D9NWueAg.js";import{G as Y}from"./github-CZtBj8bQ.js";import{E as Ee}from"./ellipsis-vertical-COc6NTvl.js";import{C as $e}from"./clock-CV0oisNo.js";import{S as Oe}from"./square-pen-CaQ0rD2U.js";/* empty css            */import"./download-BHzq6k4i.js";import"./index-Becnjq-x.js";import"./index-gOG35dkf.js";import"./index-DkUby8a3.js";import"./index-BC-ip4sp.js";import"./index-DmtIMq0f.js";import"./floating-ui.react-dom-ODH34Sgt.js";import"./index-OH_msQzS.js";import"./index-DwOlKDQm.js";import"./index-CSGd7LPk.js";import"./index-C7hwMZoy.js";import"./cookie-consent-CR7wTwap.js";import"./select-D_MCfbK8.js";import"./index-DssjTqXu.js";import"./chevron-up-BMiBX3If.js";import"./x-BKkU3iVo.js";import"./index-fJEy3cUu.js";import"./trash-2-BRVXkUm4.js";import"./sheet-0Ok6l0ab.js";import"./plus-CeOzYAGh.js";import"./appearance-dropdown-CplWtr1N.js";import"./circle-alert-5FNlBjr8.js";import"./checkbox-TCMWq4Ph.js";import"./label-DISzI683.js";import"./badge-Do30HICq.js";import"./chevron-right-BzTA_0kR.js";import"./settings-Bjly2KGq.js";import"./bell-CbXQzXBs.js";import"./users-Dah8edja.js";import"./app-logo-icon-DHSG1eGj.js";import"./log-out-BQwzfcg9.js";import"./building-BzSs3yfb.js";import"./projector-C9mKpjiA.js";import"./clipboard-list-BccoXVyt.js";import"./timer-BE1bBtuS.js";import"./file-text-D51RJe6F.js";import"./square-check-big-B68kPrbC.js";import"./ProjectFilters-C6aAJyol.js";import"./filter-button-B8qubTbI.js";import"./react-datepicker-Cpw6gAu9.js";import"./searchable-select-BHMLfEm8.js";import"./search-4eIqUzEe.js";import"./briefcase-BmAm87Tp.js";import"./user-BD4_3ZDB.js";import"./calendar-C8zGel57.js";import"./timer-reset-XwZDwRHv.js";import"./sliders-horizontal-CZJRYnNd.js";import"./input-error-9xWteZf8.js";import"./submit-button-B_eWnsfJ.js";import"./textarea-49cOPKwt.js";import"./save-B95-0usG.js";import"./alert-dialog-Dv5S2ujf.js";import"./rich-text-editor-bUsVxFlH.js";import"./list-BjNAZPQN.js";import"./format-DaJbwain.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M20 17a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3.9a2 2 0 0 1-1.69-.9l-.81-1.2a2 2 0 0 0-1.67-.9H8a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2Z",key:"4u7rpt"}],["path",{d:"M2 8v11a2 2 0 0 0 2 2h14",key:"1eicx1"}]],Z=Ce("Folders",Te),b={errors:{},call:function({data:o={},headers:d={},params:n={}}){return fetch(l("github.repositories.sync",n),{method:"POST",headers:k(d),body:JSON.stringify(o)}).then(async i=>(b.errors=w(i),i.status===z&&(b.errors={...b.errors,...K(await i.json())}),v(i),i))},route:function(o={}){return l("github.repositories.sync",o)},routeName:"github.repositories.sync",form:function(o={}){return{method:"post",url:l("github.repositories.sync",o)}}},N={errors:{},call:function({data:o={},headers:d={},params:n={}}){return fetch(l("jira.projects.sync",n),{method:"POST",headers:k(d),body:JSON.stringify(o)}).then(async i=>(N.errors=w(i),i.status===z&&(N.errors={...N.errors,...K(await i.json())}),v(i),i))},route:function(o={}){return l("jira.projects.sync",o)},routeName:"jira.projects.sync",form:function(o={}){return{method:"post",url:l("jira.projects.sync",o)}}},L={errors:{},call:function({params:o={},headers:d={},methodHead:n=!1}){return fetch(l("project.list",o),{method:n?"HEAD":"GET",headers:k(d)}).then(i=>(L.errors=w(i),v(i),i))},data:function({params:o={},headers:d={}}){return fetch(l("project.list",o),{method:"GET",headers:k(d)}).then(async n=>(L.errors=w(n),v(n),n.json()))},route:function(o={}){return l("project.list",o)},routeName:"project.list",form:function(o={}){return{method:"get",url:l("project.list",o)}}},De=[{title:"Projects",href:"/project"}];function st(){const[o,d]=m.useState(!1),[n,i]=m.useState(null),{auth:Q,filters:c,clients:S,teamMembers:P,currencies:V,isEmployee:C}=se().props,[E,W]=m.useState([]),[M,x]=m.useState(!0),[I,H]=m.useState(!1),[X,j]=m.useState(!1),[ee,$]=m.useState("create"),[re,O]=m.useState(null),[te,J]=m.useState(!1),[t,_]=m.useState({client:(c==null?void 0:c.client)||"","team-member":(c==null?void 0:c["team-member"])||"","created-date-from":(c==null?void 0:c["created-date-from"])||null,"created-date-to":(c==null?void 0:c["created-date-to"])||null,search:(c==null?void 0:c.search)||""}),h=async r=>{x(!0),H(!1);try{W(await L.data({params:r}))}catch(a){console.error("Error fetching projects:",a),H(!0)}finally{x(!1)}},p=r=>r instanceof Date?r.toISOString().split("T")[0]:typeof r=="string"&&r?r:"";return m.useEffect(()=>{const r=be(),a={client:r.client||"","team-member":r["team-member"]||"","created-date-from":r["created-date-from"]||null,"created-date-to":r["created-date-to"]||null,search:r.search||""};_(a),h(a).then();try{const T=new URLSearchParams(window.location.search);!C&&(T.get("open")||"").toLowerCase()==="true"&&($("create"),O(null),j(!0))}catch{}const s=()=>h(a);return window.addEventListener("refresh-projects",s),()=>window.removeEventListener("refresh-projects",s)},[]),e.jsxs(je,{breadcrumbs:De,children:[e.jsx(oe,{title:"Projects"}),e.jsxs("div",{className:"mx-auto flex flex-col gap-4 p-4",children:[e.jsxs("section",{className:"mb-2",children:[e.jsx("h1",{className:"text-2xl font-medium tracking-tight text-gray-800 dark:text-gray-100",children:"Project Management"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Manage your projects"})]}),e.jsxs(ce,{className:"overflow-hidden bg-white shadow-sm transition-all dark:bg-gray-800",children:[e.jsx(ne,{className:"border-b border-gray-100 p-4 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(me,{className:"text-xl",children:"Projects"}),e.jsx(q,{children:M?"Loading projects...":I?"Failed to load projects":`You have ${E.length} projects`}),(t.client||t["team-member"]||t["created-date-from"]||t["created-date-to"]||t.search)&&e.jsx(q,{className:"mt-1",children:(()=>{let r="";if(t["created-date-from"]&&t["created-date-to"]?r=`Showing projects from ${p(t["created-date-from"])} to ${p(t["created-date-to"])}`:t["created-date-from"]?r=`Showing projects from ${p(t["created-date-from"])}`:t["created-date-to"]&&(r=`Showing projects until ${p(t["created-date-to"])}`),t.client){const a=S.find(s=>s.id.toString()===t.client);a&&(r?r+=` for client "${a.name}"`:r=`Showing projects for client "${a.name}"`)}if(t["team-member"]){const a=P.find(s=>s.id.toString()===t["team-member"]);a&&(r?r+=` with team member "${a.name}"`:r=`Showing projects with team member "${a.name}"`)}return t.search&&(r?r+=` matching "${t.search}"`:r=`Showing projects matching "${t.search}"`),r})()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!C&&e.jsxs(f,{variant:t["team-member"]||t.client||t["created-date-from"]||t["created-date-to"]||t.search?"default":"outline",className:`flex items-center gap-2 ${t["team-member"]||t.client||t["created-date-from"]||t["created-date-to"]||t.search?"border-primary/20 bg-primary/10 text-primary hover:border-primary/30 hover:bg-primary/20 dark:border-primary/30 dark:bg-primary/20 dark:text-primary-foreground dark:hover:bg-primary/30":"text-gray-600 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-800"}`,onClick:()=>J(!0),children:[e.jsx(Pe,{className:`h-4 w-4 ${t["team-member"]||t.client||t["created-date-from"]||t["created-date-to"]||t.search?"text-primary dark:text-primary-foreground":""}`}),e.jsx("span",{children:t["team-member"]||t.client||t["created-date-from"]||t["created-date-to"]||t.search?"Filters Applied":"Filters"})]}),e.jsx(ie,{href:`${route("project.export")}?team-member=${t["team-member"]||""}&client=${t.client||""}&created-date-from=${p(t["created-date-from"])}&created-date-to=${p(t["created-date-to"])}&search=${t.search||""}`,label:"Export"}),!C&&e.jsxs(f,{className:"flex items-center gap-2 bg-gray-900 text-sm hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:()=>{$("create"),O(null),j(!0)},children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Project"})]})]})]})}),e.jsx(de,{className:"p-0",children:M?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(U,{className:"mb-4 h-12 w-12 animate-spin text-muted-foreground/50"}),e.jsx("h3",{className:"mb-1 text-lg font-medium",children:"Loading Projects"}),e.jsx("p",{className:"mb-4 text-muted-foreground",children:"Please wait while we fetch your projects..."})]}):I?e.jsx("div",{className:"rounded-md border border-red-200 bg-red-50 p-6 dark:border-red-800 dark:bg-red-900/20",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Z,{className:"mb-4 h-12 w-12 text-red-500"}),e.jsx("h3",{className:"mb-1 text-lg font-medium text-red-700 dark:text-red-400",children:"Failed to Load Projects"}),e.jsx("p",{className:"mb-4 text-red-600 dark:text-red-300",children:"There was an error loading your projects. Please try again."}),e.jsxs(f,{onClick:()=>h(),className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"Retry"})]})]})}):E.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(pe,{className:"w-full",children:[e.jsx(ge,{children:e.jsxs(ue,{children:[e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-xs font-medium text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-xs font-medium text-gray-500 dark:text-gray-400",children:"Client"}),e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-xs font-medium text-gray-500 dark:text-gray-400",children:"Owner"}),e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-xs font-medium text-gray-500 dark:text-gray-400",children:"Team Members"}),e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-xs font-medium text-gray-500 dark:text-gray-400",children:"Approvers"}),e.jsx(g,{className:"dark:bg-gray-750 bg-gray-50 text-right text-xs font-medium text-gray-500 dark:text-gray-400",children:"Actions"})]})}),e.jsx(fe,{children:E.map(r=>e.jsxs(ye,{className:"dark:hover:bg-gray-750 border-b border-gray-100 hover:bg-gray-50 dark:border-gray-700",children:[e.jsx(u,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.source==="github"&&r.repo_id?e.jsx(Y,{className:"h-3 w-3 text-purple-600 dark:text-purple-400"}):r.source==="jira"?e.jsx(G,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"}):null,e.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:r.name})]})}),e.jsx(u,{className:"text-sm text-gray-700 dark:text-gray-300",children:r.client?r.client.name:e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"No client"})}),e.jsx(u,{className:"text-sm text-gray-700 dark:text-gray-300",children:r.user.name}),e.jsx(u,{className:"text-sm text-gray-700 dark:text-gray-300",children:r.team_members&&r.team_members.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:r.team_members.map(a=>e.jsx("span",{className:"inline-flex items-center bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset dark:bg-blue-400/10 dark:text-blue-400 dark:ring-blue-400/30",title:a.email,children:a.name},a.id))}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"No team members"})}),e.jsx(u,{className:"text-sm text-gray-700 dark:text-gray-300",children:r.approvers&&r.approvers.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:r.approvers.map(a=>e.jsx("span",{className:"inline-flex items-center bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-700/10 ring-inset dark:bg-green-400/10 dark:text-green-400 dark:ring-green-400/30",title:a.email,children:a.name},a.id))}):e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"No approvers"})}),e.jsx(u,{className:"text-right",children:e.jsxs(le,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(f,{variant:"ghost",className:"h-8 w-8 p-0 data-[state=open]:bg-gray-100 dark:data-[state=open]:bg-gray-800",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ee,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})]})}),e.jsxs(he,{align:"end",children:[e.jsxs(y,{className:"group cursor-pointer",onSelect:a=>{a.preventDefault(),i(r.id),d(!0)},children:[e.jsx(ve,{className:"h-4 w-4 text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"}),e.jsx("span",{children:"Notes"})]}),r.user.id===Q.user.id&&e.jsxs(e.Fragment,{children:[e.jsx(R,{href:route("project.time-logs",r.id),children:e.jsxs(y,{className:"group cursor-pointer",children:[e.jsx($e,{className:"h-4 w-4 text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"}),e.jsx("span",{children:"Time Logs"})]})}),r.source==="github"&&r.repo_id&&e.jsxs(y,{className:"group cursor-pointer",onSelect:a=>{a.preventDefault(),x(!0),b.call({params:{project:r.id}}).then(s=>s.json()).then(s=>{s.success?(D.success("Project synced successfully!"),h(t).then()):(console.error("Error syncing project:",s.error),x(!1))}).catch(()=>{x(!1)})},children:[e.jsx(Y,{className:"h-4 w-4 text-purple-500 group-hover:text-purple-700 dark:text-purple-400 dark:group-hover:text-purple-300"}),e.jsx("span",{children:"Sync GitHub"})]}),r.source==="jira"&&e.jsxs(y,{className:"group cursor-pointer",onSelect:a=>{a.preventDefault(),x(!0),N.call({params:{project:r.id}}).then(s=>s.json()).then(s=>{s.success?(D.success("Project synced successfully with Jira!"),h(t).then()):(console.error("Error syncing project with Jira:",s.error),x(!1))}).catch(s=>{console.error("Failed to sync with Jira:",s),D.error("Failed to sync with Jira"),x(!1)})},children:[e.jsx(G,{className:"h-4 w-4 text-blue-500 group-hover:text-blue-700 dark:text-blue-400 dark:group-hover:text-blue-300"}),e.jsx("span",{children:"Sync Jira"})]}),e.jsxs(y,{className:"group cursor-pointer",onSelect:a=>{a.preventDefault(),$("edit"),O(r.id),j(!0)},children:[e.jsx(Oe,{className:"h-4 w-4 text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"}),e.jsx("span",{children:"Edit"})]}),e.jsx(we,{projectId:r.id,onDeleteSuccess:h})]})]})]})})]},r.id))})]})}):e.jsx("div",{className:"rounded-md border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Z,{className:"mb-4 h-12 w-12 text-gray-300 dark:text-gray-600"}),e.jsx("h3",{className:"mb-1 text-lg font-medium text-gray-800 dark:text-gray-200",children:"No Projects"}),e.jsx("p",{className:"mb-4 text-gray-500 dark:text-gray-400",children:"You haven't added any projects yet."}),e.jsx(R,{href:route("project.create"),children:e.jsxs(f,{className:"flex items-center gap-2 bg-gray-900 text-sm hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Project"})]})})]})})})]})]}),e.jsx(Se,{projectId:n,open:o,onOpenChange:r=>d(r)}),e.jsx(ke,{open:X,mode:ee,onClose:()=>j(!1),clients:S,teamMembers:P,currencies:V,projectId:re??void 0}),e.jsx(Ne,{open:te,onOpenChange:J,filters:t,clients:S,teamMembers:P,onApply:r=>{_(r);try{const a=new URLSearchParams(window.location.search),s=(A,ae)=>{const F=ae??"";F?a.set(A,F):a.delete(A)};s("client",r.client||""),s("team-member",r["team-member"]||""),s("created-date-from",r["created-date-from"]),s("created-date-to",r["created-date-to"]),s("search",r.search||"");const T=`${window.location.pathname}?${a.toString()}`;window.history.replaceState({},"",T)}catch{}h(r).then(()=>{})}})]})}export{st as default};
