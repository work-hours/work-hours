import{r as a,j as e,b as u}from"./app-CE94QcfB.js";import{B as r}from"./button-CSc-Cw7e.js";import{T as w}from"./textarea-49cOPKwt.js";import{X as B}from"./x-BKkU3iVo.js";import{S as P}from"./square-pen-CaQ0rD2U.js";import{T as z}from"./trash-2-BRVXkUm4.js";import{S as T}from"./save-B95-0usG.js";import{f as _}from"./format-DaJbwain.js";/* empty css            */import"./index-Becnjq-x.js";import"./utils-DKW5XViW.js";import"./createLucideIcon-D9NWueAg.js";function H({projectId:t,open:c,onClose:S}){const[h,f]=a.useState([]),[j,p]=a.useState(!1),[v,N]=a.useState(null),[n,d]=a.useState(""),[m,x]=a.useState(null),[y,l]=a.useState(""),o=async()=>{if(t){p(!0),N(null);try{const s=await fetch(route("project.notes",t));if(!s.ok)throw new Error("Failed to load notes");const i=await s.json();f(i)}catch(s){const i=s instanceof Error?s.message:"Failed to load notes";N(i)}finally{p(!1)}}};a.useEffect(()=>{c&&t?o():(f([]),d(""),x(null),l(""))},[c,t]);const b=async()=>{!t||n.trim()===""||await u.post(route("project.notes.store",t),{body:n},{preserveScroll:!0,onSuccess:()=>{d(""),o()}})},C=s=>{x(s.id),l(s.body)},g=()=>{x(null),l("")},E=async s=>{t&&await u.put(route("project.notes.update",{project:t,note:s}),{body:y},{preserveScroll:!0,onSuccess:()=>{g(),o()}})},k=async s=>{t&&await u.delete(route("project.notes.destroy",{project:t,note:s}),{preserveScroll:!0,onSuccess:()=>o()})};return e.jsx("div",{className:`fixed inset-y-0 right-0 z-50 w-full transform bg-white shadow-xl transition-transform duration-300 sm:w-[420px] ${c?"translate-x-0":"translate-x-full"}`,children:e.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Project Notes"}),e.jsx(r,{variant:"ghost",size:"icon",onClick:S,children:e.jsx(B,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{placeholder:"Write a quick note...",value:n,onChange:s=>d(s.target.value)}),e.jsx("div",{className:"flex justify-end",children:e.jsx(r,{onClick:b,disabled:n.trim()==="",children:"Save"})})]}),e.jsx("div",{className:"my-4 h-px bg-gray-200"}),j&&e.jsx("div",{className:"text-center text-sm text-gray-500",children:"Loading..."}),v&&e.jsx("div",{className:"text-center text-sm text-red-500",children:v}),e.jsxs("div",{className:"space-y-3",children:[h.length===0&&!j&&e.jsx("div",{className:"text-center text-sm text-gray-500",children:"No notes yet."}),h.map(s=>e.jsxs("div",{className:"rounded-md border p-3 hover:shadow-sm",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:s.user.name}),e.jsx("span",{className:"mx-1",children:"â€¢"}),e.jsx("span",{children:_(new Date(s.created_at),"PPpp")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.can_edit&&m!==s.id&&e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>C(s),children:e.jsx(P,{className:"h-4 w-4"})}),s.can_delete&&m!==s.id&&e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>k(s.id),children:e.jsx(z,{className:"h-4 w-4"})})]})]}),m===s.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{value:y,onChange:i=>l(i.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",onClick:g,children:"Cancel"}),e.jsxs(r,{onClick:()=>E(s.id),children:[e.jsx(T,{className:"mr-2 h-4 w-4"})," Update"]})]})]}):e.jsx("div",{className:"text-sm whitespace-pre-wrap text-gray-800",children:s.body})]},s.id))]})]})]})})}export{H as default};
