import{r as s,u as ae,j as e,H as se,a as oe,b as ie}from"./app-Bk4PR63W.js";import{E as le}from"./action-buttons-CALaFlZl.js";import{S as ne}from"./StatsCards-BqpicGni.js";import{T as de}from"./time-log-table-DhRlN5aO.js";import{M as me,n as ce,D as pe,a as ge,b as he,c as xe,d as ue,A as O,e as _,f as $,g as fe}from"./master-layout-DChFziky.js";import{B as l}from"./button-BGAiRGZg.js";import{C as je,a as be,b as ye,c as A,d as ke}from"./card-Dtas3RKB.js";import{L as Ne,I as ve}from"./label-HoiQ3GNm.js";import we from"./TimeLogFiltersOffCanvas-C8JMovE2.js";import Se from"./TimeLogOffCanvas-CjZU8D3l.js";import{a as M}from"./TimeLogFiltersForm-3sFDhOX9.js";import{F as Ce}from"./filter-CK6GDAjJ.js";import{c as Te}from"./createLucideIcon-CdLL0xzd.js";import{U as Le}from"./upload-Dy_xQ6ss.js";import{C as P}from"./circle-check-big-8QtwTSF-.js";import{C as H}from"./clock-oQTHBRij.js";import{C as De}from"./circle-alert-BqzIHG1p.js";/* empty css            */import"./download-Cz3VsTSC.js";import"./utils-DKW5XViW.js";import"./StatsCard-DgP_I3mb.js";import"./users-DZUcVCZB.js";import"./timer-reset-fsukqXkc.js";import"./dollar-sign-Bm2w-Hi4.js";import"./index-D-Gk-yT4.js";import"./index-D-w6wlEG.js";import"./dropdown-menu-DdvMI060.js";import"./index-Dely6azp.js";import"./index-DDqfYr5D.js";import"./index-BsY2LpXN.js";import"./index-C79L9l-a.js";import"./floating-ui.react-dom-8ikc8Qbx.js";import"./index-DiDFMmY4.js";import"./index-BJl2vPHw.js";import"./index-D5x193o-.js";import"./index-B_GyHV6l.js";import"./trash-2-C7f2dPei.js";import"./time-log-details-sheet-DzzVx0s2.js";import"./badge-BNr9aysp.js";import"./sheet-D7dB8w4W.js";import"./index-DDNv-7cB.js";import"./x-Dz3a5Yj_.js";import"./purify.es-CEVJ7K31.js";import"./briefcase-BMGbk75R.js";import"./user-C4MlcwvE.js";import"./tag-D4CKyAHb.js";import"./file-text-BEAzekmp.js";import"./calendar-days-CLzzNnKl.js";import"./info-Bu7rbUlW.js";import"./table-B_Bh9XXk.js";import"./ellipsis-vertical-1uG8dloI.js";import"./glasses-BGYPtpd2.js";import"./square-pen-Ch07ck8l.js";import"./cookie-consent-4J8V3XdM.js";import"./select-BTxuEGZI.js";import"./index-CPvS59-d.js";import"./chevron-up-F-D43jrY.js";import"./TaskController-DRILXs0Z.js";import"./jira-icon-wsasIrn-.js";import"./loader-circle-BCYeDwOj.js";import"./plus-p8BKPWNs.js";import"./appearance-dropdown-mVcvt_IG.js";import"./checkbox-DLdSU6vz.js";import"./chevron-right-BUIh066M.js";import"./settings-DsZ09whw.js";import"./bell-CQjVsOHt.js";import"./app-logo-icon-CFfAIG7o.js";import"./github-DB_zkOOK.js";import"./log-out-CHwRCYXF.js";import"./building-b-lKGHwq.js";import"./projector-DmVTEmlk.js";import"./clipboard-list-CMM2SLJn.js";import"./timer-CKwyTId6.js";import"./square-check-big-BqCCrkHI.js";import"./sliders-horizontal-CDSa6otV.js";import"./filter-button-C5BxQfOd.js";import"./react-datepicker-CNrS-JzU.js";import"./searchable-select-CIlCAQSR.js";import"./calendar-CgkFkY-D.js";import"./search-Cz_KF6xL.js";import"./input-error-aCAuibxh.js";import"./submit-button-D4bxzCEW.js";import"./tag-input-Dqvhr_jb.js";import"./save-9NB0FlW1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Fe=Te("FileSpreadsheet",Ee),Ie=[{title:"Time Log",href:"/time-log"}];function cr({timeLogs:d,filters:m,projects:x,totalDuration:B,unpaidHours:R,unpaidAmountsByCurrency:u,paidAmountsByCurrency:f,weeklyAverage:U,unbillableHours:q,tags:z,tasks:V,open:Y}){const[G,p]=s.useState(!!Y),[Z,j]=s.useState("create"),[i,b]=s.useState(null),[J,S]=s.useState(!1),{data:r,setData:Oe,get:C,processing:_e}=ae({"start-date":m["start-date"]||"","end-date":m["end-date"]||"",project:m.project||"","is-paid":m["is-paid"]||"",status:m.status||"",tag:m.tag||""}),[g,T]=s.useState(!1),[n,y]=s.useState([]),[K,k]=s.useState(!1),[N,L]=s.useState(null),[h,D]=s.useState(!1),[E,v]=s.useState(null),[F,c]=s.useState([]),w=s.useRef(null),Q=(t,a)=>{y(a?[...n,t]:n.filter(o=>o!==t))};s.useEffect(()=>{T(!!(r["start-date"]||r["end-date"]||r.project||r["is-paid"]||r.status||r.tag));const t=()=>{C(route("time-log.index"),{preserveState:!0})};return window.addEventListener("refresh-time-logs",t),()=>window.removeEventListener("refresh-time-logs",t)},[]);const W=t=>{t.target.files&&t.target.files.length>0&&L(t.target.files[0])},X=async()=>{if(!N)return;D(!0),v(null),c([]);const t=new FormData;t.append("file",N);try{const a=await oe.post(route("time-log.import"),t,{headers:{"Content-Type":"multipart/form-data"}});v(a.data.message),a.data.errors&&a.data.errors.length>0?c(a.data.errors):setTimeout(()=>I(),1e3),setTimeout(()=>{C(route("time-log.index"),{preserveState:!0})},2e3)}catch(a){const o=a;o.response&&o.response.data?o.response.data.errors?c(o.response.data.errors):o.response.data.message&&c([o.response.data.message]):c(["An unexpected error occurred. Please try again."])}finally{D(!1)}},I=()=>{L(null),v(null),c([]),w.current&&(w.current.value="")},ee=()=>{k(!1),I()},te=()=>{n.length!==0&&ie.post(route("time-log.mark-as-paid"),{time_log_ids:n},{onSuccess:()=>{y([])}})};return e.jsxs(me,{breadcrumbs:Ie,children:[e.jsx(se,{title:"Time Log"}),e.jsxs("div",{className:"mx-auto flex flex-col gap-4 p-4",children:[e.jsxs("section",{className:"",children:[e.jsx("h1",{className:"text-2xl font-medium tracking-tight text-gray-800 dark:text-gray-100",children:"Time Logs"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Track and manage your work hours"})]}),d.length>0&&e.jsx("section",{className:"",children:e.jsx(ne,{teamStats:{count:-1,totalHours:B,unpaidHours:R,unpaidAmount:Object.values(u).reduce((t,a)=>t+a,0),unpaidAmountsByCurrency:u,paidAmount:Object.values(f).reduce((t,a)=>t+a,0),paidAmountsByCurrency:f,currency:Object.keys(u)[0]||Object.keys(f)[0]||"USD",weeklyAverage:U,clientCount:-1,unbillableHours:q}})}),e.jsxs(je,{className:"overflow-hidden bg-white shadow-sm transition-all dark:bg-gray-800",children:[e.jsx(be,{className:"p-4 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ye,{className:"text-xl",children:"Your Time Logs"}),e.jsx(A,{children:d.length>0?`Showing ${d.length} time ${d.length===1?"entry":"entries"}`:"No time logs found for the selected period"}),(r["start-date"]||r["end-date"]||r.project||r.status)&&e.jsx(A,{className:"mt-1",children:(()=>{let t="";if(r["start-date"]&&r["end-date"]?t=`Showing logs from ${r["start-date"]} to ${r["end-date"]}`:r["start-date"]?t=`Showing logs from ${r["start-date"]}`:r["end-date"]&&(t=`Showing logs until ${r["end-date"]}`),r.project){const a=x.find(re=>re.id.toString()===r.project),o=a?a.name:"";t?t+=` for ${o}`:t=`Showing logs for ${o}`}if(r["is-paid"]){const a=r["is-paid"]==="true"?"paid":"unpaid";t?t+=` (${a})`:t=`Showing ${a} logs`}if(r.status){const a=r.status===M.PENDING?"pending":r.status===M.APPROVED?"approved":"rejected";t?t+=` with ${a} status`:t=`Showing logs with ${a} status`}return t})()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:g?"default":"outline",className:`flex items-center gap-2 ${g?"border-primary/20 bg-primary/10 text-primary hover:border-primary/30 hover:bg-primary/20 dark:border-primary/30 dark:bg-primary/20 dark:text-primary-foreground dark:hover:bg-primary/30":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>S(!0),children:[e.jsx(Ce,{className:`h-3 w-3 ${g?"text-primary dark:text-primary-foreground":""}`}),e.jsx("span",{children:g?"Filters Applied":"Filters"})]}),e.jsx(le,{href:route("time-log.export")+window.location.search,label:"Export"}),e.jsx("a",{href:route("time-log.template"),className:"inline-block",children:e.jsxs(l,{variant:"outline",className:"flex items-center gap-2 border-gray-200 bg-white text-gray-700 transition-all duration-200 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",children:[e.jsx(Fe,{className:"h-3 w-3"}),e.jsx("span",{children:"Template"})]})}),e.jsxs(l,{variant:"outline",className:"flex items-center gap-2 border-gray-200 bg-white text-gray-700 transition-all duration-200 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",onClick:()=>k(!0),children:[e.jsx(Le,{className:"h-3 w-3"}),e.jsx("span",{children:"Import"})]}),n.length>0&&e.jsxs(l,{onClick:te,className:"flex items-center gap-2 bg-gray-900 text-sm text-white hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",children:[e.jsx(P,{className:"h-3 w-3"}),e.jsxs("span",{children:["Mark as Paid (",n.length,")"]})]}),e.jsxs(l,{variant:"default",className:"flex items-center gap-2 bg-gray-900 text-sm text-white hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:()=>{j("create"),b(null),p(!0)},children:[e.jsx(H,{className:"h-3 w-3"}),e.jsx("span",{children:"Log Time"})]})]})]})}),e.jsx(ke,{className:"p-0",children:d.length>0?e.jsx(de,{timeLogs:d,showActions:!0,showCheckboxes:!0,selectedLogs:n,onSelectLog:Q,onEdit:t=>{j("edit"),b(t),p(!0)}}):e.jsx("div",{className:"rounded-md border bg-muted/5 p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(H,{className:"mb-4 h-12 w-12 text-muted-foreground/50"}),e.jsx("h3",{className:"mb-1 text-lg font-medium",children:"No Time Logs"}),e.jsx("p",{className:"mb-4 text-muted-foreground",children:"You haven't added any time logs yet."}),e.jsxs(l,{className:"flex items-center gap-2 bg-gray-900 text-sm text-white hover:bg-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600",onClick:()=>{j("create"),b(null),p(!0)},children:[e.jsx(ce,{className:"h-3 w-3"}),e.jsx("span",{children:"Add Time Log"})]})]})})})]}),e.jsx(pe,{open:K,onOpenChange:k,children:e.jsxs(ge,{className:"sm:max-w-md",children:[e.jsxs(he,{children:[e.jsx(xe,{children:"Import Time Logs"}),e.jsxs(ue,{children:["Upload an Excel file with time logs to import.",e.jsx("a",{href:route("time-log.template"),className:"ml-1 text-primary hover:underline",children:"Download template"})]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[e.jsx(Ne,{htmlFor:"file-upload",children:"Excel File"}),e.jsx(ve,{id:"file-upload",type:"file",accept:".xlsx,.xls",onChange:W,ref:w,disabled:h}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Only .xlsx and .xls files are supported (max 2MB)"})]}),E&&e.jsxs(O,{className:"border-green-200 bg-green-50 dark:border-green-900/30 dark:bg-green-900/20",children:[e.jsx(P,{className:"h-3 w-3 text-green-600 dark:text-green-400"}),e.jsx(_,{className:"text-green-800 dark:text-green-400",children:"Success"}),e.jsx($,{className:"text-green-700 dark:text-green-400",children:E})]}),F.length>0&&e.jsxs(O,{className:"border-red-200 bg-red-50 dark:border-red-900/30 dark:bg-red-900/20",children:[e.jsx(De,{className:"h-3 w-3 text-red-600 dark:text-red-400"}),e.jsx(_,{className:"text-red-800 dark:text-red-400",children:"Error"}),e.jsx($,{className:"text-red-700 dark:text-red-400",children:e.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-5",children:F.map((t,a)=>e.jsx("li",{children:t},a))})})]})]}),e.jsxs(fe,{className:"sm:justify-between",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:ee,disabled:h,children:"Cancel"}),e.jsx(l,{type:"button",onClick:X,disabled:!N||h,children:h?"Importing...":"Import"})]})]})})]}),e.jsx(we,{open:J,onOpenChange:S,filters:r,projects:x,tags:z,setHasActiveFilters:T}),e.jsx(Se,{open:G,mode:Z,onClose:()=>p(!1),projects:x,tasks:V,timeLog:i?{id:i.id,project_id:i.project_id||0,task_id:i.task_id??null,start_timestamp:i.start_timestamp,end_timestamp:i.end_timestamp||"",note:i.note||"",non_billable:!!i.non_billable,tags:(i.tags||[]).map(t=>t.name)}:void 0})]})}export{cr as default};
