import{u as pe,r as m,j as e,H as xe,a as k}from"./app-Bk4PR63W.js";import{A as ge}from"./approval-time-log-table-DMU9lose.js";import{S as ue}from"./StatsCard-DgP_I3mb.js";import{F as _}from"./filter-button-C5BxQfOd.js";import{M as he,D as M,a as I,b as L,c as H,d as q,A as D,e as T,f as R,g as U}from"./master-layout-DChFziky.js";import{B as j}from"./button-BGAiRGZg.js";import{C as je,a as fe,b as ve,c as Y,d as be}from"./card-Dtas3RKB.js";import{D as z,C as G}from"./react-datepicker-CNrS-JzU.js";import{L as f}from"./label-HoiQ3GNm.js";import{S as J}from"./searchable-select-CIlCAQSR.js";import{T as K}from"./textarea-hH4xkfAo.js";import{r as Ne}from"./utils-DKW5XViW.js";import{C as Q}from"./clock-oQTHBRij.js";import{S as we}from"./square-check-big-BqCCrkHI.js";import{C as F}from"./circle-alert-BqzIHG1p.js";import{C as Se}from"./calendar-CgkFkY-D.js";import{C as Ce,T as ye}from"./timer-reset-fsukqXkc.js";import{B as Ae}from"./briefcase-BMGbk75R.js";import{U as ke}from"./user-C4MlcwvE.js";import{S as De}from"./search-Cz_KF6xL.js";import{C as V}from"./circle-check-big-8QtwTSF-.js";/* empty css            */import"./time-log-details-sheet-DzzVx0s2.js";import"./badge-BNr9aysp.js";import"./index-DDqfYr5D.js";import"./sheet-D7dB8w4W.js";import"./index-DDNv-7cB.js";import"./index-Dely6azp.js";import"./index-DiDFMmY4.js";import"./index-BsY2LpXN.js";import"./index-D-w6wlEG.js";import"./index-D5x193o-.js";import"./x-Dz3a5Yj_.js";import"./createLucideIcon-CdLL0xzd.js";import"./purify.es-CEVJ7K31.js";import"./tag-D4CKyAHb.js";import"./file-text-BEAzekmp.js";import"./calendar-days-CLzzNnKl.js";import"./dollar-sign-Bm2w-Hi4.js";import"./info-Bu7rbUlW.js";import"./table-B_Bh9XXk.js";import"./glasses-BGYPtpd2.js";import"./cookie-consent-4J8V3XdM.js";import"./index-C79L9l-a.js";import"./floating-ui.react-dom-8ikc8Qbx.js";import"./index-BJl2vPHw.js";import"./select-BTxuEGZI.js";import"./index-CPvS59-d.js";import"./chevron-up-F-D43jrY.js";import"./TaskController-DRILXs0Z.js";import"./jira-icon-wsasIrn-.js";import"./loader-circle-BCYeDwOj.js";import"./trash-2-C7f2dPei.js";import"./plus-p8BKPWNs.js";import"./appearance-dropdown-mVcvt_IG.js";import"./dropdown-menu-DdvMI060.js";import"./index-B_GyHV6l.js";import"./checkbox-DLdSU6vz.js";import"./index-D-Gk-yT4.js";import"./chevron-right-BUIh066M.js";import"./settings-DsZ09whw.js";import"./bell-CQjVsOHt.js";import"./users-DZUcVCZB.js";import"./app-logo-icon-CFfAIG7o.js";import"./github-DB_zkOOK.js";import"./log-out-CHwRCYXF.js";import"./building-b-lKGHwq.js";import"./projector-DmVTEmlk.js";import"./clipboard-list-CMM2SLJn.js";import"./timer-CKwyTId6.js";const Te=[{title:"Approvals",href:"/approvals"}];function Gt({timeLogs:u,filters:v,projects:E,teamMembers:B,totalDuration:W}){const{data:r,setData:p,get:b,processing:n}=pe({"start-date":v["start-date"]||"","end-date":v["end-date"]||"",project:v.project||"",user:v.user||""}),[a,N]=m.useState([]),[X,w]=m.useState(!1),[Z,S]=m.useState(!1),[o,h]=m.useState(null),[x,i]=m.useState(""),[d,C]=m.useState(!1),[y,c]=m.useState(null),[A,l]=m.useState(null),ee=(t,s)=>{N(s?[...a,t]:a.filter(g=>g!==t))},te=t=>{h(t),i(""),c(null),l(null),w(!0)},re=t=>{h(t),i(""),c(null),l(null),S(!0)},se=()=>{a.length!==0&&(h(null),i(""),c(null),l(null),w(!0))},ae=()=>{a.length!==0&&(h(null),i(""),c(null),l(null),S(!0))},O=()=>{w(!1),h(null),i("")},P=()=>{S(!1),h(null),i("")},le=async()=>{C(!0),c(null),l(null);try{let t;o?t=await k.post(route("approvals.approve"),{time_log_id:o,comment:x}):t=await k.post(route("approvals.approve-multiple"),{time_log_ids:a,comment:x}),c(t.data.message),setTimeout(()=>{b(route("time-log.approvals"),{preserveState:!0}),O(),N([])},1500)}catch(t){const s=t;s.response&&s.response.data&&s.response.data.message?l(s.response.data.message):l("An unexpected error occurred. Please try again.")}finally{C(!1)}},oe=async()=>{C(!0),c(null),l(null);try{let t;o?t=await k.post(route("approvals.reject"),{time_log_id:o,comment:x}):t=await k.post(route("approvals.reject-multiple"),{time_log_ids:a,comment:x}),c(t.data.message),setTimeout(()=>{b(route("time-log.approvals"),{preserveState:!0}),P(),N([])},1500)}catch(t){const s=t;s.response&&s.response.data&&s.response.data.message?l(s.response.data.message):l("An unexpected error occurred. Please try again.")}finally{C(!1)}},ne=r["start-date"]?new Date(r["start-date"]):null,ie=r["end-date"]?new Date(r["end-date"]):null,de=t=>{t?p("start-date",t.toISOString().split("T")[0]):p("start-date","")},ce=t=>{t?p("end-date",t.toISOString().split("T")[0]):p("end-date","")},me=t=>{t.preventDefault(),b(route("time-log.approvals"),{preserveState:!0})};return e.jsxs(he,{breadcrumbs:Te,children:[e.jsx(xe,{title:"Approvals"}),e.jsxs("div",{className:"mx-auto flex flex-col gap-6 p-3",children:[e.jsxs("section",{className:"mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-100",children:"Pending Approvals"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Approve or reject time logs from your team members"})]}),u.length>0&&e.jsx("section",{className:"mb-4 w-3/12",children:e.jsx(ue,{title:"Total Hours",icon:e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),value:Ne(W),description:"Total pending hours to be approved",borderColor:"blue-500"})}),e.jsxs(je,{className:"transition-all hover:shadow-md",children:[e.jsxs(fe,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ve,{className:"text-xl",children:"Pending Approvals"}),e.jsx(Y,{children:u.length>0?`Showing ${u.length} pending ${u.length===1?"entry":"entries"}`:"No pending approvals found for the selected period"})]}),e.jsx("div",{className:"flex gap-2",children:a.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{onClick:se,variant:"default",className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsxs("span",{children:["Approve Selected (",a.length,")"]})]}),e.jsxs(j,{onClick:ae,variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsxs("span",{children:["Reject Selected (",a.length,")"]})]})]})})]}),e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsxs("form",{onSubmit:me,className:"flex w-full flex-row flex-wrap gap-4",children:[e.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-auto sm:flex-1",children:[e.jsx(f,{htmlFor:"start-date",className:"text-xs font-medium",children:"Start Date"}),e.jsx(z,{selected:ne,onChange:de,dateFormat:"yyyy-MM-dd",isClearable:!0,disabled:n,customInput:e.jsx(G,{id:"start-date",icon:e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),disabled:n,placeholder:"Select start date"})})]}),e.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-auto sm:flex-1",children:[e.jsx(f,{htmlFor:"end-date",className:"text-xs font-medium",children:"End Date"}),e.jsx(z,{selected:ie,onChange:ce,dateFormat:"yyyy-MM-dd",isClearable:!0,disabled:n,customInput:e.jsx(G,{id:"end-date",icon:e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"}),disabled:n,placeholder:"Select end date"})})]}),e.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-auto sm:flex-1",children:[e.jsx(f,{htmlFor:"project",className:"text-xs font-medium",children:"Project"}),e.jsx(J,{id:"project",value:r.project,onChange:t=>p("project",t),options:[{id:"",name:"All Projects"},...E],placeholder:"Select project",disabled:n,icon:e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex w-full flex-col gap-1 sm:w-auto sm:flex-1",children:[e.jsx(f,{htmlFor:"user",className:"text-xs font-medium",children:"Team Member"}),e.jsx(J,{id:"user",value:r.user,onChange:t=>p("user",t),options:[{id:"",name:"All Members"},...B],placeholder:"Select member",disabled:n,icon:e.jsx(ke,{className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(_,{title:"Apply filters",disabled:n,children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(_,{variant:"clear",disabled:n||!r["start-date"]&&!r["end-date"]&&!r.project&&!r.user,onClick:()=>{p({"start-date":"","end-date":"",project:"",user:""}),b(route("time-log.approvals"),{preserveState:!0})},title:"Clear filters",children:e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 text-sm text-muted-foreground",children:(r["start-date"]||r["end-date"]||r.project||r.user)&&e.jsx(Y,{children:(()=>{let t="";if(r["start-date"]&&r["end-date"]?t=`Showing logs from ${r["start-date"]} to ${r["end-date"]}`:r["start-date"]?t=`Showing logs from ${r["start-date"]}`:r["end-date"]&&(t=`Showing logs until ${r["end-date"]}`),r.project){const s=E.find($=>$.id.toString()===r.project),g=s?s.name:"";t?t+=` for ${g}`:t=`Showing logs for ${g}`}if(r.user){const s=B.find($=>$.id.toString()===r.user),g=s?s.name:"";t?t+=` by ${g}`:t=`Showing logs by ${g}`}return t})()})})]})]}),e.jsx(be,{children:u.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsx(ge,{timeLogs:u,showCheckboxes:!0,selectedLogs:a,onSelectLog:ee,onApprove:te,onReject:re})}):e.jsx("div",{className:"rounded-md border bg-muted/5 p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Q,{className:"mb-4 h-12 w-12 text-muted-foreground/50"}),e.jsx("h3",{className:"mb-1 text-lg font-medium",children:"No Pending Approvals"}),e.jsx("p",{className:"mb-4 text-muted-foreground",children:"There are no pending time logs that require your approval."})]})})})]}),e.jsx(M,{open:X,onOpenChange:w,children:e.jsxs(I,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(H,{children:o?"Approve Time Log":`Approve ${a.length} Time Logs`}),e.jsx(q,{children:o?"Add an optional comment and approve this time log.":`You are about to approve ${a.length} time logs. Add an optional comment.`})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[e.jsx(f,{htmlFor:"comment",children:"Comment (Optional)"}),e.jsx(K,{id:"comment",value:x,onChange:t=>i(t.target.value),placeholder:"Add a comment about this approval",disabled:d})]}),y&&e.jsxs(D,{className:"border-green-200 bg-green-50 dark:border-green-900/30 dark:bg-green-900/20",children:[e.jsx(V,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),e.jsx(T,{className:"text-green-800 dark:text-green-400",children:"Success"}),e.jsx(R,{className:"text-green-700 dark:text-green-400",children:y})]}),A&&e.jsxs(D,{className:"border-red-200 bg-red-50 dark:border-red-900/30 dark:bg-red-900/20",children:[e.jsx(F,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),e.jsx(T,{className:"text-red-800 dark:text-red-400",children:"Error"}),e.jsx(R,{className:"text-red-700 dark:text-red-400",children:A})]})]}),e.jsxs(U,{className:"sm:justify-between",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:O,disabled:d,children:"Cancel"}),e.jsx(j,{type:"button",onClick:le,disabled:d,className:"bg-green-600 text-white hover:bg-green-700",children:d?"Approving...":"Approve"})]})]})}),e.jsx(M,{open:Z,onOpenChange:S,children:e.jsxs(I,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(H,{children:o?"Reject Time Log":`Reject ${a.length} Time Logs`}),e.jsx(q,{children:o?"Add a comment explaining why you're rejecting this time log.":`You are about to reject ${a.length} time logs. Add a comment explaining why.`})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[e.jsx(f,{htmlFor:"reject-comment",children:"Comment"}),e.jsx(K,{id:"reject-comment",value:x,onChange:t=>i(t.target.value),placeholder:o?"Explain why you're rejecting this time log":"Explain why you're rejecting these time logs",disabled:d,required:!0})]}),y&&e.jsxs(D,{className:"border-green-200 bg-green-50 dark:border-green-900/30 dark:bg-green-900/20",children:[e.jsx(V,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),e.jsx(T,{className:"text-green-800 dark:text-green-400",children:"Success"}),e.jsx(R,{className:"text-green-700 dark:text-green-400",children:y})]}),A&&e.jsxs(D,{className:"border-red-200 bg-red-50 dark:border-red-900/30 dark:bg-red-900/20",children:[e.jsx(F,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),e.jsx(T,{className:"text-red-800 dark:text-red-400",children:"Error"}),e.jsx(R,{className:"text-red-700 dark:text-red-400",children:A})]})]}),e.jsxs(U,{className:"sm:justify-between",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:P,disabled:d,children:"Cancel"}),e.jsx(j,{type:"button",onClick:oe,disabled:d||!x.trim(),className:"bg-red-600 text-white hover:bg-red-700",children:d?"Rejecting...":"Reject"})]})]})})]})]})}export{Gt as default};
