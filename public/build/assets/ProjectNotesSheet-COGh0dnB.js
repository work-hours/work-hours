import{r as s,j as e,b}from"./app-CE94QcfB.js";import{A as O,a as $,b as L,c as V,d as R,e as U,f as W,g as Z}from"./alert-dialog-Dv5S2ujf.js";import{B as l}from"./button-CSc-Cw7e.js";import{R as D}from"./rich-text-editor-bUsVxFlH.js";import{S as G,a as J,b as K,c as Q,d as X}from"./sheet-0Ok6l0ab.js";import{c as k}from"./createLucideIcon-D9NWueAg.js";import{S as _}from"./square-pen-CaQ0rD2U.js";import{U as Y}from"./user-BD4_3ZDB.js";import{S as I}from"./save-B95-0usG.js";import{T as A}from"./trash-2-BRVXkUm4.js";import{f as ee}from"./format-DaJbwain.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],re=k("CalendarClock",te);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]],j=k("StickyNote",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],le=k("TriangleAlert",se);function ne({projectId:r,open:i,onOpenChange:T}){const u=t=>t.replace(/<[^>]*>/g,"").replace(/&nbsp;|\s+/g," ").trim(),[m,N]=s.useState([]),[x,f]=s.useState(!1),[y,v]=s.useState(null),[n,h]=s.useState(""),[E,g]=s.useState(null),[p,o]=s.useState(""),[M,d]=s.useState(!1),[w,S]=s.useState(null),c=async()=>{if(r){f(!0),v(null);try{const t=route("project.notes",r);console.log("Fetching notes from:",t);const a=await fetch(t);if(!a.ok){const F=await a.text();throw console.error("Error response:",a.status,F),new Error(`Failed to load notes: ${a.status} ${a.statusText}`)}const B=await a.json();N(B)}catch(t){console.error("Error fetching notes:",t);const a=t instanceof Error?t.message:"Failed to load notes";v(a)}finally{f(!1)}}};s.useEffect(()=>{i&&r?c():(N([]),h(""),g(null),o(""))},[i,r]);const H=async()=>{!r||u(n)===""||await b.post(route("project.notes.store",r),{body:n},{preserveScroll:!0,onSuccess:()=>{h(""),c()}})},P=t=>{g(t.id),o(t.body)},C=()=>{g(null),o("")},z=async t=>{r&&await b.put(route("project.notes.update",{project:r,note:t}),{body:p},{preserveScroll:!0,onSuccess:()=>{C(),c()}})},q=async t=>{r&&await b.delete(route("project.notes.destroy",{project:r,note:t}),{preserveScroll:!0,onSuccess:()=>c()})};return r?e.jsxs(G,{open:i,onOpenChange:T,children:[e.jsxs(J,{side:"right",className:"overflow-y-auto bg-white pb-4 pl-4 sm:max-w-md md:max-w-lg dark:bg-neutral-900",children:[e.jsxs(K,{className:"mb-6",children:[e.jsxs(Q,{className:"flex items-center gap-2 text-neutral-900 dark:text-white",children:[e.jsx(j,{className:"h-5 w-5 text-primary"}),"Project Notes"]}),e.jsx(X,{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"View and manage notes for this project"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-sm font-medium tracking-wider text-neutral-500 uppercase dark:text-neutral-400",children:[e.jsx(_,{className:"h-4 w-4 text-primary/80"}),"Add New Note"]}),e.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-white p-4 shadow-sm dark:border-neutral-800 dark:bg-neutral-800/50",children:[e.jsx(D,{placeholder:"Write a quick note...",value:n,onChange:t=>h(t)}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(l,{onClick:H,disabled:u(n)==="",className:"bg-neutral-900 text-white hover:bg-neutral-800 dark:bg-neutral-700 dark:hover:bg-neutral-600",children:"Save Note"})})]})]}),y&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-400",children:y}),x&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-neutral-300 border-t-primary"}),e.jsx("p",{className:"mt-2 text-sm text-neutral-500 dark:text-neutral-400",children:"Loading notes..."})]}),!x&&m.length>0&&e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("h3",{className:"flex items-center gap-2 text-sm font-medium tracking-wider text-neutral-500 uppercase dark:text-neutral-400",children:[e.jsx(j,{className:"h-4 w-4 text-primary/80"}),"Project Notes"]}),e.jsx("div",{className:"space-y-4",children:m.map(t=>e.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-white p-4 shadow-sm dark:border-neutral-800 dark:bg-neutral-800/50",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-neutral-500 dark:text-neutral-400"}),e.jsx("span",{className:"font-medium text-neutral-900 dark:text-white",children:t.user.name})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-neutral-500 dark:text-neutral-400",children:[e.jsx(re,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:ee(new Date(t.created_at),"MMM dd, yyyy HH:mm")})]})]}),E===t.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-md border border-neutral-200 bg-white dark:border-neutral-700 dark:bg-neutral-800",children:e.jsx(D,{value:p,onChange:a=>o(a)})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:C,className:"border-neutral-200 dark:border-neutral-700",children:"Cancel"}),e.jsxs(l,{onClick:()=>z(t.id),disabled:u(p)==="",className:"bg-neutral-900 text-white hover:bg-neutral-800 dark:bg-neutral-700 dark:hover:bg-neutral-600",children:[e.jsx(I,{className:"mr-2 h-4 w-4"})," Update"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prose prose-sm max-w-none rounded-md bg-neutral-50 p-3 text-neutral-700 dark:bg-neutral-800/70 dark:text-neutral-300",dangerouslySetInnerHTML:{__html:t.body}}),(t.can_edit||t.can_delete)&&e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[t.can_edit&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>P(t),className:"h-8 border-neutral-200 text-neutral-700 hover:bg-neutral-50 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",children:[e.jsx(_,{className:"mr-1 h-3 w-3"})," Edit"]}),t.can_delete&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{d(!0),S(t.id)},className:"h-8 border-red-200 bg-red-50 text-red-700 hover:bg-red-100 dark:border-red-800 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30",children:[e.jsx(A,{className:"mr-1 h-3 w-3"})," Delete"]})]})]})]},t.id))})]}),!x&&m.length===0&&e.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-8 text-center dark:border-neutral-800 dark:bg-neutral-800/50",children:[e.jsx(j,{className:"mx-auto mb-3 h-10 w-10 text-neutral-300 dark:text-neutral-600"}),e.jsx("h3",{className:"mb-1 text-lg font-medium text-neutral-800 dark:text-neutral-200",children:"No Notes"}),e.jsx("p",{className:"mb-4 text-neutral-500 dark:text-neutral-400",children:"There are no notes for this project yet."})]})]})]}),e.jsx(O,{open:M,onOpenChange:d,children:e.jsxs($,{children:[e.jsxs(L,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-red-600"}),"Confirm Delete"]}),e.jsx(R,{children:"Are you sure you want to delete this note? This action cannot be undone."})]}),e.jsxs(U,{children:[e.jsx(W,{onClick:()=>d(!1),className:"border-neutral-200 text-neutral-700 hover:bg-neutral-50 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",children:"Cancel"}),e.jsxs(Z,{onClick:()=>{w!==null&&(q(w),S(null)),d(!1)},className:"bg-red-600 text-white hover:bg-red-500 dark:bg-red-700 dark:hover:bg-red-600",children:[e.jsx(A,{className:"mr-2 h-4 w-4"})," Delete Note"]})]})]})})]}):null}const je=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{ne as P,j as S,je as a};
