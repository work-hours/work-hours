import{r as o,a as i,j as n}from"./app-Bk4PR63W.js";import{B as S}from"./badge-BNr9aysp.js";import{I as v}from"./label-HoiQ3GNm.js";import{X as T}from"./x-Dz3a5Yj_.js";function R({value:t=[],onChange:g,placeholder:x="Add tags...",className:w="",timeLogId:a}){const[c,p]=o.useState(""),[u,l]=o.useState([]),[y,f]=o.useState(!1),m=o.useRef(null);o.useEffect(()=>{a&&i.get(`/time-log/${a}/tags`).then(e=>{const s=e.data.map(r=>r.name);g(s)}).catch(e=>console.error("Error loading tags:",e))},[a]);const j=async e=>{if(!e){l([]);return}try{const s=await i.get("/tags/autocomplete",{params:{query:e}});l(s.data)}catch(s){console.error("Error fetching tag suggestions:",s)}},b=e=>{const s=e.target.value;p(s),s?(j(s),f(!0)):(l([]),f(!1))},d=e=>{var s;if(e=e.trim(),e&&!t.includes(e)){const r=[...t,e];g(r),a&&i.post(`/time-log/${a}/tags`,{tags:r}).catch(N=>console.error("Error saving tags:",N))}p(""),l([]),f(!1),(s=m.current)==null||s.focus()},h=e=>{const s=t.filter(r=>r!==e);g(s),a&&i.post(`/time-log/${a}/tags`,{tags:s}).catch(r=>console.error("Error saving tags:",r))},E=e=>{e.key==="Enter"&&c?(e.preventDefault(),d(c)):e.key==="Backspace"&&!c&&t.length>0&&h(t[t.length-1])};return n.jsxs("div",{className:`flex flex-wrap gap-2 p-1 border rounded-md ${w}`,children:[t.map(e=>n.jsxs(S,{className:"flex items-center gap-1 px-2 py-1",children:[e,n.jsx("button",{type:"button",onClick:()=>h(e),className:"flex items-center justify-center w-4 h-4 text-xs rounded-full hover:bg-gray-200",children:n.jsx(T,{className:"w-3 h-3"})})]},e)),n.jsxs("div",{className:"relative flex-1 min-w-[120px]",children:[n.jsx(v,{ref:m,value:c,onChange:b,onKeyDown:E,placeholder:t.length>0?"":x,className:"border-0 outline-none focus:ring-0 focus-visible:ring-0 h-8 p-0"}),y&&u.length>0&&n.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg",children:u.map(e=>n.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-gray-100",onClick:()=>d(e.name),children:e.name},e.id))})]})]})}export{R as T};
